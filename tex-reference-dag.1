.TH TEX-REFERENCE-DAG 1 "2025-07-29" "TeX-Reference-DAG" "User Commands"
.nh
.SH NAME
tex-reference-dag \- check LaTeX label dependencies
.SH SYNOPSIS
.B tex-reference-dag
.I aux-file
.I tex-files...
.RI [ options ]
.SH DESCRIPTION
.B tex-reference-dag
reads the LaTeX
.I .aux
and
.I .tex
files of a project and verifies that the numbering of labelled statements
(like theorems or definitions) respects the dependency order given by
their references.  A topological ordering of the dependency graph is
printed and optional TikZ graphs can be generated.

The program first reads the \fC.aux\fR file to map every label to its
numerical counter.  It then scans the provided \fC.tex\fR files for
\fC\\label{...}\fR commands and for reference macros specified via a
\fBconfiguration file\fR.  Each reference introduces a directed edge from the closest
preceding label to the referenced label.  NetworkX is used to analyse
the resulting graph, detect cycles and compute a topological order.
If a label is referenced before its number appears in this order, the
violation is reported together with a suggested renumbering.
Labels should follow the form \fC\\label{<type>:<name>}\fR, e.g.
\fC\\label{lem:zorn}\fR.  Entries with types \fCfig\fR and \fCeq\fR are
ignored by default because their counters are independent of the section
structure.  Additional types can be excluded via the macro configuration
file.  The same file may define an \fCenv_map\fR object mapping label
prefixes to the environments that contain them.  References are collected
only inside the environment of each label, ensuring correct attribution.
Labels whose prefix is one of \fClem\fR, \fCthm\fR, \fCprop\fR or \fCcor\fR
also include an immediately following \fCproof\fR environment in this scan so
that dependencies mentioned there are considered.
.SH OPTIONS
.TP
.B --config
JSON file providing reference macros and default flag values. Command
line options always override the values specified here.  It can also
include an \fCenv_map\fR section mapping label prefixes to environment
names. If omitted, the built-in defaults (\fC\\reflem \\refdef \\refthm
\\refcor \\ref\fR with no future reference macros, theorem labels
\fClem\fR, \fCthm\fR, \fCprop\fR and \fCcor\fR, and excluding types
\fCfig\fR and \fCeq\fR) are used.
.TP
.B --draw-dir
Directory where TikZ graphs are written (default: \fCgraphs\fR).
.TP
.B --draw-each-section
Generate a TikZ graph for every section showing local dependencies.
.TP
.B --draw-collapsed-sections
Generate a collapsed DAG where each node represents a section.
Isolated nodes without edges are omitted from all generated graphs to keep
the output concise.
.TP
.B --layout
Layout algorithm for generated TikZ graphs. One of \fCdot\fR, \fCspring\fR, or
\fCkamada_kawai\fR (default).
.SH ARGUMENTS
.TP
.I aux-file
Path to the LaTeX \fC.aux\fR file.
.TP
.I tex-files
One or more \fC.tex\fR files that are scanned for labels and references.
.SH TECHNICAL NOTES
The program first uses the given \fC.aux\fR file to find out the names of all labels.
This only works if the latest version of the LaTeX project has been compiled (twice) already,
as only then the correct labels are inside the \fC.aux\fR file.
Then the program iterates through the \fC.tex\fR files and searches the labels there.
If a label is found, its environment (and in the case of a theorem-style environment the
following proof-environment) is searched for any references.
The label is then linked to those references in the DAG.

This process has the following important consequences:
.IP \(BU 2
- Only environments with labels are able to even appear in the graph
.IP \(BU 2
- If an environment without label references an environment (which then necessarily has a label)
this is not visible to the program.


.SH EXAMPLES
.TP
Run on a typical project after compilation:
.EX
$ python tex-reference-dag.py main.aux *.tex
.EE
.TP
Use a configuration file (e.g. \fCmacros.example.json\fR) and draw graphs:
.EX
$ python tex-reference-dag.py main.aux chap*.tex --config macros.json \
  --draw-dir graphs --draw-collapsed-sections --draw-each-section
.EE
.SH SEE ALSO
.BR python (1),
.BR networkx (1)
.SH AUTHOR
Written by Lino Joss Fidel Haupt.
